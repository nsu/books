<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Book Suggestions</title>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/3.0.1/normalize.min.css">
  <link rel="stylesheet" href="ember-app/css/style.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootswatch/3.2.0/yeti/bootstrap.min.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- fixes for facebook auth URL bug -->
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script src="ember-app/js/fb-urlfix.js"></script>
</head>
<body>
  <script type="text/x-handlebars">
      <div class="pull-right btn-group btn-group-xs"> <!-- extra '+' menu for suggestions & login -->
        <i class="fa fa-plus-square-o fa-2x dropdown-toggle cursor-pointer" data-toggle="dropdown"></i>
        <ul class="dropdown-menu" role="menu">
          <li>
            {{#link-to 'index'}} 
                <i class="fa fa-home"></i> Home
            {{/link-to}}
          </li>
          <li>
            {{#link-to 'list'}} 
                <i class="fa fa-th-list"></i> Suggestions
            {{/link-to}}
          </li>
          <li>
            <a href="/auth/facebook"><i class="fa fa-facebook-square"></i > Login</a>
          </li>
        </ul>
      </div> <!-- end dropdown -->
    {{outlet}}
  </script>

  <script type="text/x-handlebars" id="index">
    <div class="container">
    <div class="row text-center">
        <img class="icon" src="ember-app/img/book.svg" height="150px" width="150px">
    </div>

    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            {{input class="form-control input-lg" type=text value=searchQuery placeholder="Search..."}}
            <div style="margin-top:20px" class="well">
                {{# unless selected_book }}
                {{#each suggestions}}
                <div style="padding-bottom: 10px" class="row">
                    <div class="col-md-1">
                        <img {{bind-attr src=this.smallThumbnail}}>
                    </div>
                    <div class="col-md-9">
                        <div style="margin-left:15px" class="content-heading">
                            <h3 class="nomargin-bottom">{{this.title}}</h3>
                            <h4 class="nomargin-top"><small>{{this.author}}</small></h4>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <h3>
                            <button {{action "select_suggestion" this}} type="button" class="pull-right btn btn-primary">Select</button>
                        </h3>
                    </div>
                </div>
                {{/each}}
                {{/unless}}
                {{#if selected_book }}
                <div class="book-display">
                    <div class="row">
                        <div class="col-md-3">
                            <img {{bind-attr src=selected_book.thumbnail}}>
                        </div>
                        <div id="selected-book" class="col-md-9">
                            <div class="content-heading">
                                <h3 class="nomargin-bottom nomargin-top">{{selected_book.title}}</h3>
                                <h4 class="nomargin-top"><small>{{selected_book.author}}</small></h4>
                                {{truncate 525 selected_book.description}}
                            </div>
                        </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-3">
                            <button {{action "clear_selection"}} type="button" class="btn btn-block btn-lg btn-default">
                               Return
                            </button>
                        </div>
                        <div class="col-md-9">
                            {{#if selected_book.suggested}}
                                <button type="button" class="btn btn-block btn-lg btn-success disabled">This is a Suggested Book</button>
                            {{else}}
                                <button {{action "suggest_book"}} type="button" class="btn btn-block btn-lg btn-primary">Suggest This Book</button>
                            {{/if}}
                        </div>
                    </div>
                </div>
                {{/if}}
            </div> <!-- end well -->
    </div>
  </div>
  </script>

    <script type="text/x-handlebars" id="list">
        <div class="container">
        <div style="padding-bottom: 10px" class="row">
            <div class="col-md-4" style="margin-left: 3px"> 
                {{#link-to 'list' 'all' 1}}<i class="text-info fa fa-adjust cursor-pointer"></i>{{/link-to}}
                {{#link-to 'list' 'read' 1}}<i class="text-success fa fa-circle cursor-pointer"></i>{{/link-to}}
                {{#link-to 'list' 'unread' 1}}<i class="text-muted fa fa-circle-o cursor-pointer"></i>{{/link-to}}
            </div>
        </div> 
        {{#with anon as inner_anon}}
        {{#each}}
        <div style="padding-bottom: 10px" class="row">
            <div class="col-md-1">
                <img {{bind-attr src=this.smallThumbnail}}>
            </div>
            <div class="col-md-8">
                <div style="margin-left:15px" class="content-heading">
                    <h3 class="nomargin-bottom">{{this.title}}</h3>
                    <h4 class="nomargin-top"><small>{{this.author}}</small></h4>
                </div>
            </div>
            <div class="col-md-3">
                <h3>
                    <a {{bind-attr href=this.amazon_link disabled=this.linkable}} class="btn btn-primary">Amazon</a>
                    {{# unless this.read }}
                    <button {{bind-attr disabled=inner_anon}} {{action "toggle_read" this}} type="button" class="btn btn-default">Unread</button>
                    {{else}}
                    <button {{bind-attr disabled=inner_anon}} {{action "toggle_read" this}} type="button" class="btn btn-success">Read</button>
                    {{/unless}}
                    {{#unless inner_anon}}
                    <i {{action "hide_item" this}} style="margin-top:12px;" class="fa fa-close cursor-pointer pull-right"></i>
                    {{/unless}}
                </h3>
            </div>
        </div>
        {{/each}}
        {{/with}}

        <div class="row">
        <div class="col-md-2">
        {{#if prev_page_num }}
            {{#link-to 'list' read_status prev_page_num}} 
                <i class="fa fa-chevron-left fa-lg"></i>
                <h2 style="vertical-align: -8%" class="inline">prev</h2> 
            {{/link-to}}
        {{/if}}
        </div>
        <div class="col-md-2 col-md-offset-8">
        {{#if next_page_num }}
            {{#link-to 'list' read_status next_page_num}} 
                <div style="margin-left: 30%">
                    <h2 style="vertical-align: -8%" class="inline">next</h2> 
                    <i class="fa fa-chevron-right fa-lg"></i>
                </div>
            {{/link-to}}
        {{/if}}
        </div>
        </div> <!-- end row -->
        </div>
    </script>

  <!-- Ember libs and app -->
  <!--<script src="ember-app/js/libs/jquery-1.10.2.js"></script>
  <script src="ember-app/js/libs/handlebars-1.1.2.js"></script>
  <script src="ember-app/js/libs/ember-1.7.0.js"></script> -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.3.0/handlebars.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/ember.js/1.7.0/ember.min.js"></script>
  <script src="ember-app/js/app.js"></script> 
  <!-- bootstrap -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <!-- to activate the test runner, add the "?test" query string parameter -->
  <script src="ember-app/tests/runner.js"></script>
  <!-- google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-26275906-3', 'auto');
    ga('send', 'pageview');
  
  </script>
</body>
</html>
